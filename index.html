<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>é¡§å®¢æ»¿æ„åº¦å•å·</title>

  <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>

  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --accent:#0057b8;
      --muted:#667085;
      --success:#0f9d58;
      --radius:14px;
      font-family:"Noto Sans TC","Microsoft JhengHei",system-ui;
    }

    html,body{
      margin:0;
      background:linear-gradient(180deg,#eef2ff 0%,var(--bg) 100%);
    }

    .wrap{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .card{
      width:100%;
      max-width:560px;
      background:#fff;
      border-radius:14px;
      box-shadow:0 10px 30px rgba(16,24,40,.08);
      padding:24px;
    }

    h1{margin:0 0 6px;font-size:20px}
    p.lead{margin:0 0 18px;color:var(--muted);font-size:14px}

    form{display:flex;flex-direction:column;gap:18px}

    .field{display:flex;flex-direction:column;gap:8px}
    label.question{font-weight:600;font-size:14px}

    .options{display:flex;gap:10px;flex-wrap:wrap}

    textarea,select,input[type="date"]{
      padding:10px;
      border-radius:8px;
      border:1px solid rgba(0,0,0,.15);
      font-size:14px;
    }

    .btn{
      padding:12px;
      border-radius:10px;
      border:none;
      background:var(--accent);
      color:#fff;
      font-weight:700;
      cursor:pointer;
    }

    .btn[disabled]{opacity:.6}

    .note{font-size:12px;color:var(--muted)}

    .done{
      display:none;
      text-align:center;
      padding:18px;
      border-radius:12px;
      border:1px solid rgba(15,157,88,.25);
      background:rgba(15,157,88,.06);
    }
    .field label:not(.question){
     display: flex;
     align-items: flex-start; /* checkbox èˆ‡æ–‡å­—é ‚ç«¯å°é½Š */
     gap: 8px;
     line-height: 1.5;
   }

    .field label input[type="checkbox"]{
    margin-top: 3px; /* å¾®èª¿å°é½Šç¬¬ä¸€è¡Œæ–‡å­— */
   }

    .done h3{margin:0;color:var(--success)}
  </style>
</head>

<body>

<div class="wrap">
  <div class="card">

    <h1>é¡§å®¢æ»¿æ„åº¦å•å·</h1>
    <p class="lead">è«‹èŠ± 1 åˆ†é˜å›ç­”å¹¾å€‹å•é¡Œï¼Œæ‚¨çš„å›é¥‹å°æˆ‘å€‘å¾ˆé‡è¦ã€‚</p>

    <div id="status">æ­£åœ¨è¼‰å…¥...</div>

    <!-- å·²å¡«å¯« -->
    <div id="doneArea" class="done">
      <h3>æ‚¨å·²å¡«å¯«éæ­¤å•å·ï¼Œæ„Ÿè¬æ‚¨çš„å›é¥‹ï¼</h3>
    </div>

    <!-- å•å· -->
    <div id="surveyArea" style="display:none;">
      <form id="surveyForm">

        <input type="hidden" name="UID" id="UID">

        <h3>ä¸€ã€åŸºæœ¬è³‡æ–™</h3>

        <div class="field">
          <label class="question">1. æ‚¨çš„æ€§åˆ¥</label>
          <select name="gender" required>
            <option value="">è«‹é¸æ“‡</option>
            <option>ç”·</option>
            <option>å¥³</option>
            <option>ä¸ä¾¿é€éœ²</option>
          </select>
        </div>

        <div class="field">
          <label class="question">2. æ‚¨çš„å¹´é½¡</label>
          <select name="ageRange" required>
            <option value="">è«‹é¸æ“‡</option>
            <option>20æ­²ä»¥ä¸‹</option>
            <option>21â€“30æ­²</option>
            <option>31â€“40æ­²</option>
            <option>41â€“50æ­²</option>
            <option>51æ­²ä»¥ä¸Š</option>
          </select>
        </div>

        <div class="field">
          <label class="question">3. æœ¬æ¬¡æ¶ˆè²»çš„é–€å¸‚</label>
          <select name="store" required>
            <option value="">è«‹é¸æ“‡</option>
            <option>è¥¿å€</option><option>å¤§é‡Œ</option><option>æ–—å…­</option>
            <option>å¤§åŸ”</option><option>æ¼¢å£</option><option>å¤ªå¹³</option>
            <option>æ¾ç«¹</option><option>æ±å±±</option><option>å“¡æ—</option>
            <option>ç¾æ‘å—</option><option>çƒæ—¥</option><option>åŒ—å¹³</option>
            <option>é»æ˜</option><option>ç²¾èª </option><option>ç²¾æ­¦æ±</option>
            <option>å¤§é›…</option>
          </select>
        </div>

        <div class="field">
          <label class="question">4. æœ¬æ¬¡æ¶ˆè²»æ—¥æœŸ</label>
          <input type="date" name="purchaseDate" required>
        </div>

        <h3>äºŒã€é–€å¸‚æœå‹™é«”é©—</h3>

        <div class="field">
          <label class="question">å°æ–¼é–€å¸‚æ¶ˆè²»é«”é©—ï¼Œæ‚¨çš„æ•´é«”æ»¿æ„åº¦æ˜¯ï¼Ÿ</label>
          <div class="options">
            <label><input type="radio" name="overallScore" value="1" required> 1</label>
            <label><input type="radio" name="overallScore" value="2"> 2</label>
            <label><input type="radio" name="overallScore" value="3"> 3</label>
            <label><input type="radio" name="overallScore" value="4"> 4</label>
            <label><input type="radio" name="overallScore" value="5"> 5</label>
          </div>
        </div>

        <div class="field" id="lowScoreArea" style="display:none;">
          <label class="question">è«‹å•æˆ‘å€‘åœ¨å“ªäº›æ–¹é¢å¯ä»¥å†åŠ å¼·ï¼Ÿï¼ˆå¯è¤‡é¸ï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="æ¥å¾…äº’å‹•">æ¥å¾…äº’å‹•ï¼ˆå¸Œæœ›äº’å‹•æ›´ç©æ¥µæˆ–æ›´å¤šé—œæ³¨ï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="å•†å“ä»‹ç´¹">å•†å“ä»‹ç´¹ï¼ˆå¸Œæœ›è³‡è¨Šèƒ½æ›´å®Œæ•´æˆ–æ¸…æ¥šï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="é«”é©—æµç¨‹">é«”é©—æµç¨‹ï¼ˆå¸Œæœ›æœ‰æ›´å¤šè©¦ç”¨æˆ–å±•ç¤ºæ©Ÿæœƒï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="æœå‹™æ…‹åº¦">æœå‹™æ…‹åº¦ï¼ˆå¸Œæœ›èƒ½æ›´æœ‰è€å¿ƒæˆ–è¦ªåˆ‡ï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="çµå¸³èˆ‡èªªæ˜">çµå¸³èˆ‡èªªæ˜ï¼ˆå¸Œæœ›ä¿å›ºèˆ‡æ³¨æ„äº‹é …æ›´æ¸…æ¥šï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="å•†å“é¸æ“‡">å•†å“é¸æ“‡ï¼ˆå¸Œæœ›æ¬¾å¼ï¼è¦æ ¼æœ‰æ›´å¤šé¸æ“‡ï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="å•†å“é©é…åº¦">å•†å“é©é…åº¦ï¼ˆå¸Œæœ›æ›´å®¹æ˜“æ‰¾åˆ°é©åˆçš„å•†å“ï¼‰</label>
          <label><input type="checkbox" name="improve[]" value="åƒ¹æ ¼èˆ‡åƒ¹å€¼æ„Ÿå—">åƒ¹æ ¼èˆ‡åƒ¹å€¼æ„Ÿå—ï¼ˆæœŸå¾…æ›´ç¬¦åˆé æœŸï¼‰</label>
          <input type="text" name="improveOther" placeholder="å…¶ä»–">
        </div>

        <div class="field" id="highScoreArea" style="display:none;">
          <label class="question">åœ¨æ¶ˆè²»éç¨‹ä¸­ï¼Œè®“æ‚¨æ„Ÿè¦ºä¸éŒ¯çš„åœ°æ–¹ï¼Ÿ</label>
          <label><input type="checkbox" name="good[]" value="äººå“¡è¦ªåˆ‡"> äººå“¡è¦ªåˆ‡æœ‰ç¦®</label>
          <label><input type="checkbox" name="good[]" value="å•†å“å°ˆæ¥­"> å•†å“è³‡è¨Šæ¸…æ¥šï¼Œå°ˆæ¥­èªªæ˜å……è¶³</label>
          <label><input type="checkbox" name="good[]" value="å•†å“ç¬¦åˆéœ€æ±‚"> æä¾›è©¦ç”¨/é«”é©—å•†å“çš„æ©Ÿæœƒ</label>
           <label><input type="checkbox" name="good[]" value="çµå¸³èˆ‡èªªæ˜"> çµå¸³èˆ‡ä¿å›ºèªªæ˜æ¸…æ¥šÂ </label>
           <label><input type="checkbox" name="good[]" value="æ²’æœ‰ç‰¹åˆ¥æ„Ÿè¦º"> æ²’æœ‰ç‰¹åˆ¥æ„Ÿè¦º</label>
           <label><input type="checkbox" name="good[]" value="å•†å“é©é…åº¦"> å•†å“ç¬¦åˆéœ€æ±‚</label>
           <label><input type="checkbox" name="good[]" value="åƒ¹æ ¼èˆ‡åƒ¹å€¼æ„Ÿå—"> å•†å“åƒ¹æ ¼èˆ‡åƒ¹å€¼ç¬¦åˆ</label>
           <label><input type="checkbox" name="good[]" value="å•†å“é¸æ“‡"> å•†å“é¸æ“‡å¤šã€å¥½æ¯”è¼ƒ</label>
          <input type="text" name="goodOther" placeholder="å…¶ä»–">
        </div>

        <div class="field">
          <label class="question">åŸºæ–¼æœ¬æ¬¡çš„é«”é©—ï¼Œè‹¥æœªä¾†æœ‰éœ€æ±‚ï¼Œæ‚¨é¡˜æ„å†æ¬¡è®“æˆ‘å€‘ç‚ºæ‚¨æœå‹™ï¼Ÿï¼ˆ1ï¼å®Œå…¨ä¸æœƒï¼Œ5ï¼éå¸¸é¡˜æ„ï¼‰</label>
          <div class="options">
            <label><input type="radio" name="recommend" value="1" required> 1</label>
            <label><input type="radio" name="recommend" value="2"> 2</label>
            <label><input type="radio" name="recommend" value="3"> 3</label>
            <label><input type="radio" name="recommend" value="4"> 4</label>
            <label><input type="radio" name="recommend" value="5"> 5</label>
          </div>
        </div>

        <h3>ä¸‰ã€é–‹æ”¾å¼å›é¥‹</h3>

        <div class="field">
          <label class="question">1.æœ¬æ¬¡æœå‹™ä¸­ï¼Œæœ‰æ²’æœ‰è®“æ‚¨å°è±¡è¼ƒæ·±åˆ»çš„åœ°æ–¹ï¼Ÿ</label>
          <textarea name="open1" rows="3"></textarea>
        </div>

        <div class="field">
          <label class="question">2.æœªä¾†æ‚¨å¸Œæœ›æˆ‘å€‘åœ¨å“ªäº›åœ°æ–¹åšå¾—æ›´å¥½ï¼Ÿ</label>
          <textarea name="open2" rows="3"></textarea>
        </div>

        <div class="note">å°æé†’ï¼šå•å·å®Œæˆå¾Œï¼Œè³¼ç‰©é‡‘å°‡æ–¼ä¸‹é€±ä¸‰çµ±ä¸€ç™¼é€ï¼Œè¬è¬æ‚¨çš„è€å¿ƒç­‰å€™ğŸ˜Š</div>
        <div class="note">æ‚¨çš„å›è¦†åƒ…ä½œç‚ºå…§éƒ¨æ”¹å–„ä½¿ç”¨</div>

        <button id="submitBtn" type="submit" class="btn">é€å‡ºå•å·</button>

      </form>
    </div>
  </div>
</div>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbzCphcqbEMUOcioq-owF9Q5jbtHvYRCAvxOm3Qb3lZLJd8ULYcrrFWhwA_CmIibtHKm/exec";

document.addEventListener("DOMContentLoaded", async () => {
  try{
    await liff.init({ liffId: "2001230327-l7YbvL9o" });
    const profile = await liff.getProfile();
    document.getElementById("UID").value = profile.userId;

     // ğŸ”¹ æª¢æŸ¥æ˜¯å¦å·²å¡«å¯«ï¼ˆé€™æ®µå¯ç¶­æŒ jsonï¼‰
    const res = await fetch(`${GAS_URL}?uid=${profile.userId}&check=1`);
    const data = await res.json();

    document.getElementById("status").style.display = "none";

    if (data.filled) {
      document.getElementById("doneArea").style.display = "block";
    } else {
      document.getElementById("surveyArea").style.display = "block";
    }

    const lowScoreArea = document.getElementById("lowScoreArea");
const highScoreArea = document.getElementById("highScoreArea");

function clearCheckboxes(selector) {
  document.querySelectorAll(selector).forEach(cb => {
    cb.checked = false;
  });
}

document.querySelectorAll('input[name="overallScore"]').forEach(r => {
  r.addEventListener("change", () => {
    const v = Number(r.value);

    if (v <= 3) {
      // é¡¯ç¤ºç¼ºé»ã€æ¸…ç©ºäº®é»
      lowScoreArea.style.display = "block";
      highScoreArea.style.display = "none";
      clearCheckboxes('input[name="good[]"]');
      document.querySelector('input[name="goodOther"]').value = "";
    } else {
      // é¡¯ç¤ºäº®é»ã€æ¸…ç©ºç¼ºé»
      lowScoreArea.style.display = "none";
      highScoreArea.style.display = "block";
      clearCheckboxes('input[name="improve[]"]');
      document.querySelector('input[name="improveOther"]').value = "";
    }
  });
});

  } catch (e) {
    document.getElementById("status").textContent = "è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦";
    console.error(e);
  }
});

document.getElementById("surveyForm").addEventListener("submit", async e => {
  e.preventDefault();

  const submitBtn = document.getElementById("submitBtn");
  const surveyArea = document.getElementById("surveyArea");
  const doneArea = document.getElementById("doneArea");

  submitBtn.disabled = true;
  submitBtn.textContent = "é€å‡ºä¸­â€¦";

   try {
    await fetch(GAS_URL, {
      method: "POST",
      body: new FormData(e.target)
    });
  } catch (err) {
    // ä¸é¡¯ç¤ºéŒ¯èª¤ï¼Œé¿å…èª¤åˆ¤
    console.warn("fetch éè‡´å‘½éŒ¯èª¤", err);
  }

  // ä¸€å¾‹é¡¯ç¤ºå®Œæˆç•«é¢
  surveyArea.style.display = "none";
  doneArea.style.display = "block";
});
</script>
</script>

</body>
</html>


</body>
</html>
