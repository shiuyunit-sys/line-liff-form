<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>顧客滿意度問卷</title>
  <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
  <style>
    /* --- 全域樣式 --- */
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --accent:#0057b8;
      --muted:#667085;
      --success:#0f9d58;
      --radius:14px;
      --glass: rgba(255,255,255,0.75);
      font-family: "Noto Sans TC", "Microsoft JhengHei", -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(180deg, #eef2ff 0%, var(--bg) 100%);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .wrap{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
      box-sizing:border-box;
    }

    .card{
      width:100%;
      max-width:560px;
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:0 10px 30px rgba(16,24,40,0.08);
      padding:28px;
      box-sizing:border-box;
      backdrop-filter: blur(6px);
      border: 1px solid rgba(16,24,40,0.04);
    }

    h1{font-size:20px;margin:0 0 8px;color:#0f172a}
    p.lead{margin:0 0 18px;color:var(--muted);font-size:14px}

    form{display:flex;flex-direction:column;gap:18px}

    .field{
      display:flex;flex-direction:column;gap:8px;
    }

    label.question{
      font-weight:600;color:#0f172a;font-size:14px;
    }

    /* 選項容器 */
    .options{display:flex;gap:10px;flex-wrap:wrap}

    .option{
      display:inline-flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;border:1px solid rgba(16,24,40,0.06);background:var(--glass);cursor:pointer;user-select:none;transition:all .18s ease;
    }

    .option input{appearance:none;display:inline-block;width:18px;height:18px;border-radius:6px;border:2px solid rgba(16,24,40,0.12);background:transparent}
    .option input:checked{background:var(--accent);border-color:var(--accent);box-shadow:0 0 0 4px rgba(0,87,184,0.08)}

    .note{font-size:12px;color:var(--muted)}

    .btn{
      display:inline-flex;align-items:center;justify-content:center;padding:12px 16px;border-radius:10px;border:0;background:var(--accent);color:#fff;font-weight:700;cursor:pointer;font-size:14px;transition:transform .12s ease;
    }
    .btn:active{transform:translateY(1px)}
    .btn[disabled]{opacity:.6;cursor:default}

    .status{display:flex;align-items:center;gap:10px;color:var(--muted)}

    /* 已填寫區塊 */
    .done{display:none;text-align:center;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(15,157,88,0.06),transparent);border:1px solid rgba(15,157,88,0.12)}
    .done h3{color:var(--success);margin:0}

    /* 響應 */
    @media (max-width:480px){
      .card{padding:18px;border-radius:12px}
      .option{padding:10px}
    }
  </style>
</head>

<body>

<div class="wrap">
  <div class="card" role="region" aria-labelledby="title">
    <h1 id="title">顧客滿意度問卷</h1>
    <p class="lead">請花 1 分鐘回答幾個問題，您的回饋對我們很重要。</p>

    <div id="status" class="status">正在載入...</div>

    <!-- 問卷區 -->
    <div id="surveyArea" style="display:none;">
      <form id="surveyForm">
        <input type="hidden" name="UID" id="UID">
　　<h3>一、基本資料</h3>

    <div class="field">
      <label class="question">1. 您的性別：</label>
      <select name="gender" required>
        <option value="">請選擇</option>
        <option value="男">男</option>
        <option value="女">女</option>
        <option value="不便透露">不便透露</option>
      </select>
    </div>
    <div class="field">
      <label class="question">2. 您的年齡：</label>
      <input type="number" name="age" min="0" max="120" required>
    </div>
    <div class="field">
      < <label class="question">3. 本次消費的門市：</label>
      <select name="store" required>
        <option value="">請選擇門市</option>
        <option value="門市1">西區</option>
        <option value="門市2">大里</option>
        <option value="門市3">斗六</option>
        <option value="門市4">大埔</option>
        <option value="門市5">漢口</option>
        <option value="門市6">太平</option>
        <option value="門市7">松竹</option>
        <option value="門市8">東山</option>
        <option value="門市9">員林</option>
        <option value="門市10">美村南</option>
        <option value="門市11">烏日</option>
        <option value="門市12">北平</option>
        <option value="門市13">黎明</option>
        <option value="門市14">精誠</option>
        <option value="門市15">精武東</option>
        <option value="門市16">大雅</option>
        <!-- 依序填入16家門市 -->
      </select>
     <div class="field">
      <label class="question">4. 本次消費日期：</label>
      <input type="date" name="purchaseDate" required>
    </div>
     <div class="field">
      <label class="question">5. 本次購買的商品種類：</label>
      <div>
        <label><input type="checkbox" name="productType" value="保護殼"> 保護殼</label>
        <label><input type="checkbox" name="productType" value="保護貼"> 保護貼</label>
        <label><input type="checkbox" name="productType" value="鏡頭膜"> 鏡頭膜</label>
        <label><input type="checkbox" name="productType" value="充電線"> 充電線</label>
        <label><input type="checkbox" name="productType" value="充電器"> 充電器</label>
        <label><input type="checkbox" name="productType" value="行動電源"> 行動電源</label>
        <label><input type="checkbox" name="productType" value="平板套"> 平板套</label>
        <label><input type="checkbox" name="productType" value="手錶配件"> 手錶配件</label>
        <label><input type="checkbox" name="productType" value="掛繩"> 掛繩</label>
      </div>
      <input type="text" name="productOther" placeholder="其他：___________">
    </div>
    <h3>二、門市人員服務流程滿意度</h3>
        <div class="field">
          <label class="question">1. 迎賓與主動關心<br>本次服務中，是否有主動向您問候？<span class="note">(必填)</span></label>
          <div class="options" role="radiogroup" aria-labelledby="q1">
            <label class="option"><input type="radio" name="Q1" value="人員主動向我問候並關心需求" required> 人員主動向我問候並關心需求</label>
            <label class="option"><input type="radio" name="Q1" value="在我開口後才開始互動"> 在我開口後才開始互動</label>
            <label class="option"><input type="radio" name="Q1" value="幾乎沒有主動互動"> 幾乎沒有主動互動</label>
          </div>
        </div>

        <div class="field">
          <label class="question">2. 人員是否有先了解您的使用需求，再推薦商品？ <span class="note">(必填)</span></label>
          <div class="options" role="radiogroup">
            <label class="option"><input type="radio" name="Q2" value="有，並清楚了解我的需求" required> 有，並清楚了解我的需求</label>
            <label class="option"><input type="radio" name="Q2" value="僅確認手機型號，未多問其他習慣"> 僅確認手機型號，未多問其他習慣</label>
            <label class="option"><input type="radio" name="Q2" value="幾乎沒有，直接推薦"> 幾乎沒有，直接推薦</label>
          </div>
        </div>
      <div class="field">
      <label class="question">3. 人員詢問需求的方式是否讓您感到自然、不造成壓力？（1=非常不滿意，5=非常滿意）<span class="note">(必填)</span></label>
        <div>
          <label><input type="radio" name="question1Rating" value="1" required> 1</label>
          <label><input type="radio" name="question1Rating" value="2"> 2</label>
          <label><input type="radio" name="question1Rating" value="3"> 3</label>
          <label><input type="radio" name="question1Rating" value="4"> 4</label>
          <label><input type="radio" name="question1Rating" value="5"> 5</label>
        </div>
      </div>
       <div class="field">
          <label class="question">4. 人員推薦商品時，是否能說明該商品「符合您哪項需求」或「解決什麼問題」？ <span class="note">(必填)</span></label>
          <div class="options" role="radiogroup">
            <label class="option"><input type="radio" name="Q4" value="有，能具體說明推薦理由，並符合我的狀況" required> 有，能具體說明推薦理由，並符合我的狀況</label>
            <label class="option"><input type="radio" name="Q4" value="有簡單介紹功能，但未特別連結我的需求"> 有簡單介紹功能，但未特別連結我的需求</label>
            <label class="option"><input type="radio" name="Q4" value="僅照著包裝念或只談價格，沒什麼特別說明"> 僅照著包裝念或只談價格，沒什麼特別說明</label>
          </div>
        </div>
       <div class="field">
          <label class="question">5. 人員介紹商品是否清楚、簡單易懂？  請以 1～5 分評價（1=非常不滿意，5=非常滿意） <span class="note">(必填)</span></label>
           <div>
              <label><input type="radio" name="question1Rating" value="1" required> 1</label>
              <label><input type="radio" name="question1Rating" value="2"> 2</label>
              <label><input type="radio" name="question1Rating" value="3"> 3</label>
              <label><input type="radio" name="question1Rating" value="4"> 4</label>
              <label><input type="radio" name="question1Rating" value="5"> 5</label>
           </div>
        </div>
        <div class="field">
          <label class="question">6. 是否有邀請您實際試裝或體驗商品？ <span class="note">(必填)</span></label>
          <div class="options" role="radiogroup">
            <label class="option"><input type="radio" name="Q6" value="有主動邀請" required> 有主動邀請</label>
            <label class="option"><input type="radio" name="Q6" value="在我詢問後才提供"> 在我詢問後才提供</label>
            <label class="option"><input type="radio" name="Q6" value="沒有"> 沒有</label>
            <label class="option"><input type="radio" name="Q6" value="不適用（無實品可試/不需要）"> 不適用（無實品可試/不需要）</label>
          </div>
        </div>
        <div class="field">
          <label class="question">7. 是否有說明商品的使用方式或保養注意事項？ <span class="note">(必填)</span></label>
          <div class="options" role="radiogroup">
            <label class="option"><input type="radio" name="Q6" value="有主動且清楚說明" required> 有主動且清楚說明</label>
            <label class="option"><input type="radio" name="Q6" value="有簡單提到"> 有簡單提到</label>
            <label class="option"><input type="radio" name="Q6" value="沒有特別說明"> 沒有特別說明</label>
          </div>
        </div>
        <div class="field">
          <label class="question">8. 人員整體服務態度（耐心、親切）是否讓您感到舒適？  請以 1～5 分評價（1=非常不滿意，5=非常滿意) <span class="note">(必填)</span></label>
          <div>
              <label><input type="radio" name="question1Rating" value="1" required> 1</label>
              <label><input type="radio" name="question1Rating" value="2"> 2</label>
              <label><input type="radio" name="question1Rating" value="3"> 3</label>
              <label><input type="radio" name="question1Rating" value="4"> 4</label>
              <label><input type="radio" name="question1Rating" value="5"> 5</label>
           </div>
        </div>
        <div class="field">
          <label class="question">9. 您對本次購物體驗的整體滿意度為？  請以 1～5 分評價（1=非常不滿意，5=非常滿意）<span class="note">(必填)</span></label>
          <div>
              <label><input type="radio" name="question1Rating" value="1" required> 1</label>
              <label><input type="radio" name="question1Rating" value="2"> 2</label>
              <label><input type="radio" name="question1Rating" value="3"> 3</label>
              <label><input type="radio" name="question1Rating" value="4"> 4</label>
              <label><input type="radio" name="question1Rating" value="5"> 5</label>
           </div>
        </div>
        
    <h3>三、開放式回饋</h3>  
        <div class="field">
          <label class="question">有哪些地方我們還可以做得更好？</label>
          <textarea name="comment" rows="4" placeholder="例如：服務哪裡可以改進、想要的商品或活動..." style="resize:vertical;padding:10px;border-radius:8px;border:1px solid rgba(16,24,40,0.06);font-size:14px;"></textarea>
        </div>
        <div class="field">
          <label class="question">我們有那些服務是讓您感受到最印象深刻的？</label>
          <textarea name="comment" rows="4" placeholder="例如：服務哪裡可以改進、想要的商品或活動..." style="resize:vertical;padding:10px;border-radius:8px;border:1px solid rgba(16,24,40,0.06);font-size:14px;"></textarea>
        </div>
       <div class="field">
          <label class="question">您願意推薦我們給親友嗎，讓您更願意再回來？</label>
          <textarea name="comment" rows="4" placeholder="例如：服務哪裡可以改進、想要的商品或活動..." style="resize:vertical;padding:10px;border-radius:8px;border:1px solid rgba(16,24,40,0.06);font-size:14px;"></textarea>
        </div>
   <h3>四、整體推薦度</h3>     
        <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;">
          <div class="note">您的回覆將保密，僅作為內部改進使用。</div>
          <button class="btn" id="submitBtn" type="submit">送出問卷</button>
        </div>
      </form>
    </div>

    <!-- 已填寫顯示 -->
    <div id="doneArea" class="done" style="display:none;">
      <h3>您已經填寫過本次問卷，感謝您的參與！</h3>
      <p class="note">若需要修改回覆，請聯絡我們的門市人員或客服。</p>
    </div>

  </div>
</div>

<script>
  // ★ 請保留或替換為您自己的 GAS 部署網址
  const GAS_URL = "https://script.google.com/macros/s/AKfycbzCphcqbEMUOcioq-owF9Q5jbtHvYRCAvxOm3Qb3lZLJd8ULYcrrFWhwA_CmIibtHKm/exec";

  document.addEventListener("DOMContentLoaded", async () => {
    try{
      await liff.init({ liffId: "2001230327-l7YbvL9o" });
      const profile = await liff.getProfile();
      const uid = profile.userId;
      document.getElementById('UID').value = uid;

      // 檢查是否已填寫
      const statusEl = document.getElementById('status');
      statusEl.textContent = '正在檢查是否已填寫...';

      const res = await fetch(`${GAS_URL}?uid=${encodeURIComponent(uid)}&check=1`);
      const data = await res.json();

      statusEl.style.display = 'none';

      if (data && data.filled) {
        document.getElementById('doneArea').style.display = 'block';
      } else {
        document.getElementById('surveyArea').style.display = 'block';
      }

    }catch(err){
      console.error(err);
      document.getElementById('status').textContent = '載入失敗，請確認網路或 LIFF 設定。';
    }
  });

  // 表單送出
  document.getElementById('surveyForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const submitBtn = document.getElementById('submitBtn');
    submitBtn.disabled = true;
    submitBtn.textContent = '送出中...';

    const form = e.target;
    const formData = new FormData(form);

    try{
      const res = await fetch(GAS_URL, { method: 'POST', body: formData });
      const result = await res.json();

      if (result && result.status === 'success'){
        document.getElementById('surveyArea').style.display = 'none';
        const done = document.getElementById('doneArea');
        done.style.display = 'block';
        done.querySelector('h3').textContent = '問卷已送出，感謝您的寶貴意見！';
      }else{
        alert('送出失敗，請稍後再試。');
        submitBtn.disabled = false;
        submitBtn.textContent = '送出問卷';
      }

    }catch(err){
      console.error(err);
      alert('無法送出（網路或服務端錯誤）。');
      submitBtn.disabled = false;
      submitBtn.textContent = '送出問卷';
    }
  });
</script>

</body>
</html>
